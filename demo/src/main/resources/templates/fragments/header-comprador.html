<header th:fragment="siteHeader">
    <link rel="stylesheet" th:href="@{/header.css}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <div class="header-premium" id="mainHeader">
        <div class="header-container">
            <!-- Logo -->
            <div class="header-logo">
                <a th:href="@{/}">
                    <img th:src="@{/images/isotipoWhite.png}" alt="Cultivus">
                    <span class="logo-text">Cultivus</span>
                </a>
            </div>

            <!-- Navegación Principal -->
            <nav class="header-nav">
                <a th:href="@{/}" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span>Inicio</span>
                </a>
                <a th:href="@{/category}" class="nav-link">
                    <i class="fas fa-th-large"></i>
                    <span>Categorías</span>
                </a>
                <a th:href="@{/category}" class="nav-link">
                    <i class="fas fa-shopping-basket"></i>
                    <span>Productos</span>
                </a>
            </nav>

            <!-- Buscador -->
            <div class="header-search">
                <button class="search-toggle" id="searchToggle">
                    <i class="fas fa-search"></i>
                </button>
                <div class="search-dropdown" id="searchDropdown">
                    <form th:action="@{/buscar}" method="get">
                        <input type="search" name="q" placeholder="Buscar productos..." autocomplete="off">
                        <button type="submit">
                            <i class="fas fa-search"></i>
                        </button>
                    </form>
                </div>
            </div>

            <!-- CTAs -->
            <div class="header-actions">
                <!-- CTA Convertirse en Vendedor -->
                <a th:href="@{/vendedor/registro}" class="btn-sell">
                    <i class="fas fa-store"></i>
                    <span>Vender</span>
                </a>

            <div class="header-nav">
                <!-- Mi Perfil -->
                <a th:href="@{/usuario/perfil}" class="btn-profile-link">
                    <i class="fas fa-user-circle"></i>  
                </a>

                <!-- Cerrar Sesión -->
                <a th:href="@{/usuario/logout}" class="btn-logout">
                    <i class="fas fa-sign-out-alt"></i>
                </a>
            </div>

                <!-- Carrito -->
                <a th:href="@{/carrito}" class="btn-cart">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="cart-badge">0</span>
                </a>
            </div>

            <!-- Mobile Menu Toggle -->
            <button class="mobile-menu-toggle" id="mobileMenuToggle">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </div>

    <!-- Mobile Menu -->
    <div class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <span>Menú</span>
            <button class="mobile-menu-close" id="mobileMenuClose">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <nav class="mobile-nav">
            <a th:href="@{/}"><i class="fas fa-home"></i> Inicio</a>
            <a th:href="@{/category}"><i class="fas fa-th-large"></i> Categorías</a>
            <a th:href="@{/category}"><i class="fas fa-shopping-basket"></i> Productos</a>
            <div class="mobile-divider"></div>
            <a th:href="@{/vendedor/registro}" class="mobile-highlight"><i class="fas fa-store"></i> Convertirse en Vendedor</a>
            <a th:href="@{/usuario/perfil}"><i class="fas fa-user"></i> Mi Perfil</a>
            <a th:href="@{/usuario/logout}"><i class="fas fa-sign-out-alt"></i> Cerrar Sesión</a>
        </nav>
    </div>

    <script>
        // Search Toggle
        const searchToggle = document.getElementById('searchToggle');
        const searchDropdown = document.getElementById('searchDropdown');
        
        if (searchToggle && searchDropdown) {
            searchToggle.addEventListener('click', () => {
                searchDropdown.classList.toggle('active');
                if (searchDropdown.classList.contains('active')) {
                    searchDropdown.querySelector('input').focus();
                }
            });

            document.addEventListener('click', (e) => {
                if (!e.target.closest('.header-search')) {
                    searchDropdown.classList.remove('active');
                }
            });
        }


        // Mobile Menu
        const mobileMenuToggle = document.getElementById('mobileMenuToggle');
        const mobileMenu = document.getElementById('mobileMenu');
        const mobileMenuClose = document.getElementById('mobileMenuClose');

        if (mobileMenuToggle && mobileMenu) {
            mobileMenuToggle.addEventListener('click', () => {
                mobileMenu.classList.add('active');
                document.body.style.overflow = 'hidden';
            });

            mobileMenuClose.addEventListener('click', () => {
                mobileMenu.classList.remove('active');
                document.body.style.overflow = '';
            });
        }

        // Sticky Header
        let lastScroll = 0;
        const header = document.getElementById('mainHeader');

        window.addEventListener('scroll', () => {
            const currentScroll = window.pageYOffset;
            
            if (currentScroll > 50) {
                header.classList.add('scrolled');
            } else {
                header.classList.remove('scrolled');
            }

            lastScroll = currentScroll;
        });
    </script>
</header>